import argparse

from ..src.config import generate_individual_terraform_account_modules


def main(
    local_terraform_user_config_dir_path: str,
    terraform_modules_dir: str,
    org_output_path: str,
    accounts_tf_build_dir: str,
    iam_inputs_path: str,
) -> None:
    """Generates an terraform module for individual organization accounts.

    Args:
        local_terraform_user_config_dir_path (str): Path to Terraform user configuration
            directory.
        terraform_modules_dir (str): Path to Terraform module directory
        org_output_path (str): Path to Terraform org_output.json file.
        accounts_tf_build_dir (str): Path to Terraform build accounts directory
        iam_inputs_path (str): JSON file generated by the `generate_initial_iam_inputs`
            method
    """
    generate_individual_terraform_account_modules(
        config_dir_path=local_terraform_user_config_dir_path,
        tf_modules_dir=terraform_modules_dir,
        org_output_path=org_output_path,
        accounts_tf_build_dir=accounts_tf_build_dir,
        iam_inputs_path=iam_inputs_path,
    )


if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="Generates iam root Terraform module and input variables."
    )
    parser.add_argument(
        "local_terraform_user_config_dir_path",
        help="Path to Terraform user configuration directory",
    )
    parser.add_argument(
        "terraform_modules_dir",
        help="Path to Terraform modules directory",
    )
    parser.add_argument(
        "org_output_path",
        help="Path to Terraform org_output.json file.",
    )
    parser.add_argument(
        "accounts_tf_build_dir",
        help="Path to Terraform build accounts directory",
    )
    parser.add_argument(
        "iam_inputs_path",
        help="JSON file generated by the `generate_initial_iam_inputs` method",
    )

    args = parser.parse_args()
    main(
        args.local_terraform_user_config_dir_path,
        args.terraform_modules_dir,
        args.org_output_path,
        args.accounts_tf_build_dir,
        args.iam_inputs_path,
    )
